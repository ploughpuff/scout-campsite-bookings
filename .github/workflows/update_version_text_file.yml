name: Update Version Text File on Tag Creation

on:
  push:
    tags:
      - 'v*.*.*'

jobs:
  update_version:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Ensure we're on the default branch
        run: |
          git checkout main  # or 'master' if that's your default branch

      - name: Get the latest tag and update version.txt
        run: |
          echo $(git describe --tags) > version.txt

      - name: Commit and push updated version.txt
        run: |
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"
          git add version.txt
          git commit -m "Update version.txt"
          git push origin main
